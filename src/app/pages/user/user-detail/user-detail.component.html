<div class="user-detail-wrapper">
  <div class="user-detail-header">
    <div class="header-content">
      <h1 class="header-title">{{ isOwnProfile ? 'Mi Perfil' : 'Perfil del Usuario' }}</h1>
      <p class="header-subtitle">{{ isOwnProfile ? 'Informaci贸n de tu cuenta' : 'Informaci贸n del usuario' }}</p>
    </div>
  </div>

  <div class="user-detail-container">
    @if (isLoading) {
      <app-spinner message="Cargando datos del perfil..." size="md"></app-spinner>
    } @else if (user) {
      <div class="card user-card">
        <div class="card-body">
          <div class="detail-header">
            <div class="detail-content">
              <h2 class="detail-title">Informaci贸n Personal</h2>
            </div>

            <!-- User Image -->
            @if (user.photo_url) {
              <div class="user-image-box">
                <img [src]="user.photo_url" alt="Foto de perfil" class="user-image" />
              </div>
            }
          </div>

          <!-- User Info -->
          <div class="user-info">
            <!-- Name -->
            <div class="info-section">
              <label class="info-label">Nombre Completo</label>
              <p class="info-value">{{ user.name }}</p>
            </div>

            <!-- Email -->
            <div class="info-section">
              <label class="info-label">Correo Electr贸nico</label>
              <p class="info-value">{{ user.email }}</p>
            </div>

            <!-- Phone -->
            @if (user.phone) {
              <div class="info-section">
                <label class="info-label">Tel茅fono</label>
                <p class="info-value">{{ user.phone }}</p>
              </div>
            }

            <!-- Bio -->
            @if (user.bio) {
              <div class="info-section">
                <label class="info-label">Biograf铆a</label>
                <p class="info-value">{{ user.bio }}</p>
              </div>
            }

            <!-- Interests -->
            @if (user.interests) {
              <div class="info-section full-width">
                <label class="info-label">Intereses</label>
                <div class="chips-container">
                  @for (interest of parseInterests(user.interests); track interest) {
                    <span class="chip">{{ interest }}</span>
                  }
                </div>
              </div>
            }

            <!-- Average Rating -->
            @if (user.average_rating !== undefined && user.average_rating !== null) {
              <div class="info-section">
                <label class="info-label">Puntuaci贸n Promedio</label>
                <p class="info-value">
                  {{ user.average_rating | number:'1.1-2' }}
                  <i class="bi bi-star-fill" style="color: #ffc107;"></i>
                </p>
              </div>
            }

            <!-- Rating Count -->
            @if (user.rating_count !== undefined && user.rating_count !== null) {
              <div class="info-section">
                <label class="info-label">N煤mero de Valoraciones</label>
                <p class="info-value">{{ user.rating_count }}</p>
              </div>
            }

            <!-- Created At -->
            @if (user.created_at) {
              <div class="info-section">
                <label class="info-label">Miembro desde</label>
                <p class="info-value">{{ formatDate(user.created_at) }}</p>
              </div>
            }
          </div>

          <!-- Actions -->
          <div class="detail-actions">
            <button
              type="button"
              class="btn btn-secondary"
              (click)="onBack()"
            >
              Volver
            </button>
            @if (isOwnProfile) {
              <button
                type="button"
                class="btn btn-primary"
                (click)="onEditProfile()"
              >
                <i class="bi bi-pencil"></i> Editar Perfil
              </button>
            }
          </div>

          <!-- Test Form (Development only) -->
          <div class="test-form-section">
            <div class="test-form-separator"></div>
            <h3 class="test-form-title">И Formulario de Prueba</h3>
            <p class="test-form-description">Prueba la navegaci贸n entre perfiles</p>
            <div class="test-form-container">
              <div class="test-form-options">
                <label class="test-form-radio">
                  <input
                    type="radio"
                    name="profileType"
                    value="own"
                    [(ngModel)]="testProfileType"
                  />
                  Ver mi perfil (sin ID)
                </label>
                <label class="test-form-radio">
                  <input
                    type="radio"
                    name="profileType"
                    value="other"
                    [(ngModel)]="testProfileType"
                  />
                  Ver perfil de otro usuario
                </label>
              </div>

              @if (testProfileType === 'other') {
                <input
                  type="number"
                  class="form-control"
                  [(ngModel)]="testUserId"
                  placeholder="Ingresa el ID del usuario"
                  min="1"
                />
              }

              <button
                type="button"
                class="btn btn-primary"
                (click)="onNavigateToUserProfile()"
              >
                Ver Perfil
              </button>
            </div>
          </div>
        </div>
      </div>
    }
  </div>
</div>

<!-- Modal Alert -->
<app-modal-alert
  [isVisible]="modalVisible"
  [title]="modalTitle"
  [message]="modalMessage"
  [type]="modalType"
  [redirectUrl]="modalRedirectUrl"
  (onClose)="onModalClose()"
></app-modal-alert>


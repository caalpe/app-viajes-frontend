<div class="change-password-wrapper">
  <div class="user-form-header">
    <div class="header-content">
      <h1 class="header-title">Cambiar Contraseña</h1>
      <p class="header-subtitle">Actualiza tu contraseña para mantener tu cuenta segura</p>
    </div>
  </div>

  <div class="change-password-container">
    <div class="tabs-wrapper">
      <div class="tabs-nav">
        <a routerLink="/user/profile/edit" class="tab-btn profile-tab">
          <i class="bi bi-person"></i>
          Mi Perfil
        </a>
        <button
          class="tab-btn"
          [class.active]="true"
          type="button"
          disabled
        >
          <i class="bi bi-shield-lock"></i>
          Seguridad
        </button>
      </div>
    </div>

    <div class="card password-card with-tabs">
      <div class="card-body">
        <h2 class="form-section-title">Cambiar Contraseña</h2>
        <p class="form-section-subtitle">Ingresa una nueva contraseña para tu cuenta</p>

        <form [formGroup]="changePasswordForm" (ngSubmit)="onSubmit()" novalidate>
          <!-- New Password -->
          <div class="mb-4">
            <label class="form-label" for="newPassword">Nueva Contraseña *</label>
            <div class="password-input-wrapper">
              <input
                id="newPassword"
                [type]="passwordVisible ? 'text' : 'password'"
                class="form-control"
                formControlName="newPassword"
                placeholder="Mínimo 8 caracteres"
              />
              <button
                type="button"
                class="btn-toggle-password"
                (click)="togglePasswordVisibility()"
                tabindex="-1"
              >
                <i [class]="passwordVisible ? 'bi bi-eye-slash' : 'bi bi-eye'"></i>
              </button>
            </div>
            @if (changePasswordForm.get('newPassword')?.touched && changePasswordForm.get('newPassword')?.invalid) {
              <div class="invalid-feedback d-block mt-2">
                La contraseña debe tener mínimo 8 caracteres.
              </div>
            }
            @if (validationErrors['newPassword']) {
              <div class="invalid-feedback d-block mt-2">
                {{ validationErrors['newPassword'] }}
              </div>
            }
          </div>

          <!-- Confirm Password -->
          <div class="mb-4">
            <label class="form-label" for="confirmPassword">Confirmar Contraseña *</label>
            <div class="password-input-wrapper">
              <input
                id="confirmPassword"
                [type]="confirmPasswordVisible ? 'text' : 'password'"
                class="form-control"
                formControlName="confirmPassword"
                placeholder="Repite tu nueva contraseña"
              />
              <button
                type="button"
                class="btn-toggle-password"
                (click)="toggleConfirmPasswordVisibility()"
                tabindex="-1"
              >
                <i [class]="confirmPasswordVisible ? 'bi bi-eye-slash' : 'bi bi-eye'"></i>
              </button>
            </div>
            @if (changePasswordForm.get('confirmPassword')?.touched && changePasswordForm.get('confirmPassword')?.invalid) {
              <div class="invalid-feedback d-block mt-2">
                La contraseña debe tener mínimo 8 caracteres.
              </div>
            }
            @if (validationErrors['confirmPassword']) {
              <div class="invalid-feedback d-block mt-2">
                {{ validationErrors['confirmPassword'] }}
              </div>
            }
          </div>

          <!-- Buttons -->
          <div class="form-actions">
            <button
              type="button"
              class="btn btn-cancel"
              (click)="onCancel()"
            >
              Cancelar
            </button>

            <button
              type="submit"
              class="btn btn-create"
              [disabled]="isSubmitting"
            >
              {{ isSubmitting ? 'Actualizando...' : 'Actualizar Contraseña' }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Modal Alert -->
<app-modal-alert
  [isVisible]="modalVisible"
  [title]="modalTitle"
  [message]="modalMessage"
  [type]="modalType"
  [redirectUrl]="modalRedirectUrl"
  (onClose)="onModalClose()"
></app-modal-alert>

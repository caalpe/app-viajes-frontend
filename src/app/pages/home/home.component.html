<section class="hero">
	<div class="hero-inner container">
		<h1>Viaja. Descubre. Vive.</h1>
		<p class="lead">Encuentra las mejores ofertas y experiencias únicas para tu próxima aventura.</p>

		<form class="search-form" [formGroup]="searchForm" (ngSubmit)="onSearch()">
			<div class="field">
				<label class="label-accent">Destino</label>
				<input type="text" formControlName="destination" placeholder="¿A dónde?" list="destinations" />
				<datalist id="destinations">
					@for (dest of destinations; track dest) {
						<option [value]="dest"></option>
					}
				</datalist>
			</div>

			<div class="field">
				<label class="label-accent" [class.label-error]="searchForm.errors?.['dateRange']">Desde</label>
				<input type="date" formControlName="from" placeholder="dd/mm/aaaa"
					[class.input-error]="searchForm.errors?.['dateRange'] && (fromControl?.touched || toControl?.touched)" />
			</div>

			<div class="field">
				<label class="label-accent" [class.label-error]="searchForm.errors?.['dateRange']">Hasta</label>
				<input type="date" formControlName="to" placeholder="dd/mm/aaaa"
					[class.input-error]="searchForm.errors?.['dateRange'] && (fromControl?.touched || toControl?.touched)" />
			</div>

			<div class="field">
				<label class="label-accent label-budget">Presupuesto</label>
				<div class="input-with-addon">
					<input type="number" formControlName="budget" min="0" placeholder="0" />
					<span class="addon">€</span>
				</div>
			</div>

		@if (searchForm.errors?.['dateRange']) {
			<div class="form-error-full">
				La fecha "Desde" debe ser anterior o igual a la fecha "Hasta".
			</div>
		}

		@if (budgetControl?.invalid && (budgetControl?.dirty || budgetControl?.touched)) {
			<div class="form-error-full">
				El presupuesto debe ser un número mayor o igual a 0.
			</div>
		}			<div class="field action-bottom">
				<button class="btn primary" type="submit">Buscar</button>
			</div>
		</form>
	</div>
</section>

<section class="features container">
	<div class="features-grid">
		@for (f of features; track f.title) {
			<div class="feature">
				<h3>{{ f.title }}</h3>
				<p>{{ f.desc }}</p>
			</div>
		}
	</div>
</section>

<section class="trips container">
	<h2>Viajes recomendados</h2>
	@if (trips$ | async; as trips) {
		@if (trips.length > 0) {
			<div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
				@for (trip of trips; track trip.id_trip) {
					<div class="col">
						<app-trip-card [tripInfo]="trip" [type]="cardType.none"></app-trip-card>
					</div>
				}
			</div>
		} @else {
			<div class="alert alert-info text-center">
				<i class="bi bi-info-circle me-2"></i>
				No se encontraron viajes. Intenta ajustar los filtros de búsqueda.
			</div>
		}
	} @else {
		<div class="text-center py-5">
			<div class="spinner-border text-primary" role="status">
				<span class="visually-hidden">Cargando viajes...</span>
			</div>
		</div>
	}
</section>

<section class="cta">
	<div class="container cta-inner">
		<h2>Listo para tu próxima aventura?</h2>
		<p>Reserva ahora y obtén descuentos exclusivos en destinos seleccionados.</p>
		<a routerLink="/trips" class="btn primary large">Empieza ahora</a>
	</div>
</section>
